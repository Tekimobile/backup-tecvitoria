{"createdAt":"2025-07-09T20:43:13.635Z","updatedAt":"2025-07-10T09:10:21.546Z","id":"FdXQjvvC6zJPNOIw","name":"Cadastro Incubados - Z-API copy 3","active":false,"isArchived":false,"nodes":[{"parameters":{"functionCode":"const inputData = $input.all()[0].json;\n\nconsole.log('Input data received:', JSON.stringify(inputData, null, 2));\n\n// Extract data from AI Agent\nlet dadosDoAgent = null;\n\nif (inputData.output && typeof inputData.output === 'object') {\n  dadosDoAgent = inputData.output;\n} else if (inputData.chatInput) {\n  dadosDoAgent = inputData.chatInput;\n} else if (inputData.message) {\n  dadosDoAgent = inputData.message;\n}\n\nconsole.log('Dados extraídos do agent:', JSON.stringify(dadosDoAgent, null, 2));\n\n// Initialize variables\nlet nome = '';\nlet projeto = '';\nlet email = '';\nlet whatsapp = '';\nlet respostas = {};\nlet pontuacao = 0;\nlet isComplete = false;\nlet perguntasMultiplaEscolha = [];\n\nif (dadosDoAgent) {\n  nome = dadosDoAgent.nome || '';\n  projeto = dadosDoAgent.projeto || '';\n  email = dadosDoAgent.email || '';\n  whatsapp = dadosDoAgent.whatsapp || '';\n  respostas = dadosDoAgent.respostas || {};\n\n  // Separar pergunta e opções numeradas do texto da resposta\n  if (dadosDoAgent.resposta) {\n    // CORREÇÃO: Preservar quebras de linha no texto original\n    const textoOriginal = dadosDoAgent.resposta.trim();\n\n    // Regex para capturar opções numeradas, considerando quebras de linha\n    const regexOpcoes = /(?:\\(\\s*\\)\\s*)?(\\d\\s*-\\s*[^\\n\\r(]+)/g;\n    const opcoes = [];\n    let match;\n\n    while ((match = regexOpcoes.exec(textoOriginal)) !== null) {\n      const opcaoLimpa = match[1].trim();\n      opcoes.push(opcaoLimpa);\n    }\n\n    // Remove as opções do texto para extrair apenas a pergunta\n    // Mantém as quebras de linha na pergunta\n    let textoPergunta = textoOriginal.replace(regexOpcoes, '').trim();\n    \n    // Remove linhas vazias excessivas (mais de 2 quebras consecutivas)\n    textoPergunta = textoPergunta.replace(/\\n{3,}/g, '\\n\\n');\n\n    // CONVERSÃO DE QUEBRAS DE LINHA PARA Z-API\n    // Converte quebras reais para \\n literal que a Z-API aceita\n    textoPergunta = textoPergunta\n      .replace(/\\n/g, '\\\\n')        // Quebra real vira \\n literal\n      .replace(/\\r\\n/g, '\\\\n')      // Windows line break\n      .replace(/\\r/g, '\\\\n');       // Mac line break\n\n    if (opcoes.length > 0 && textoPergunta.length > 0) {\n      perguntasMultiplaEscolha.push({\n        pergunta: textoPergunta,\n        opcoes: opcoes\n      });\n    }\n  }\n\n  console.log('Dados processados:', {\n    nome, projeto, email, whatsapp, respostas\n  });\n\n  // Verificar se todos os campos obrigatórios foram preenchidos\n  const dadosCompletos = nome && projeto && email && whatsapp;\n\n  // Verificar se todas as respostas obrigatórias estão completas\n  const respostasCompletas = respostas && \n    (respostas.modeloNegocio === \"true\" || respostas.modeloNegocio === \"false\") &&\n    (respostas.tamSamSom === \"true\" || respostas.tamSamSom === \"false\") &&\n    ['dados_organizados', 'informal', 'nao_realizei'].includes(respostas.pesquisaQualitativa) &&\n    ['dados_organizados', 'informal', 'nao_realizei'].includes(respostas.concorrentes) &&\n    (respostas.persona === \"true\" || respostas.persona === \"false\") &&\n    (respostas.pitch === \"true\" || respostas.pitch === \"false\") &&\n    (respostas.programasAnteriores === \"true\" || respostas.programasAnteriores === \"false\");\n\n  console.log('Validação detalhada:', {\n    dadosCompletos,\n    respostasCompletas,\n    modeloNegocio: respostas.modeloNegocio,\n    tamSamSom: respostas.tamSamSom,\n    pesquisaQualitativa: respostas.pesquisaQualitativa,\n    concorrentes: respostas.concorrentes,\n    persona: respostas.persona,\n    pitch: respostas.pitch,\n    programasAnteriores: respostas.programasAnteriores,\n    nome, projeto, email, whatsapp\n  });\n\n  // Calcular pontuação\n  pontuacao = 0;\n  pontuacao += (respostas.modeloNegocio === \"true\") ? 1 : 0;\n  pontuacao += (respostas.tamSamSom === \"true\") ? 1 : 0;\n\n  if (respostas.pesquisaQualitativa === 'dados_organizados') {\n    pontuacao += 2;\n  } else if (respostas.pesquisaQualitativa === 'informal') {\n    pontuacao += 1;\n  }\n\n  if (respostas.concorrentes === 'dados_organizados') {\n    pontuacao += 2;\n  } else if (respostas.concorrentes === 'informal') {\n    pontuacao += 1;\n  }\n\n  pontuacao += (respostas.persona === \"true\") ? 1 : 0;\n  pontuacao += (respostas.pitch === \"true\") ? 1 : 0;\n\n  pontuacao = parseInt(pontuacao) || 0;\n\n  console.log('Pontuação calculada:', pontuacao);\n\n  if (dadosCompletos && respostasCompletas) {\n    isComplete = true;\n  }\n}\n\n// Definir resultado com base na pontuação\nlet resultado = '';\nlet status = '';\n\nif (isComplete) {\n  if (pontuacao === 8) {\n    resultado = 'Aprovado para Incubação';\n    status = 'aprovado_incubacao';\n  } else if (pontuacao >= 4 && pontuacao <= 7) {\n    resultado = 'Trilha Avançada';\n    status = 'trilha_avancada';\n  } else {\n    resultado = 'Trilha Inicial';\n    status = 'trilha_inicial';\n  }\n}\n\n// Preparar saída\nconst respostasOutput = {\n  modeloNegocio: respostas.modeloNegocio === \"true\" ? true : respostas.modeloNegocio === \"false\" ? false : respostas.modeloNegocio,\n  tamSamSom: respostas.tamSamSom === \"true\" ? true : respostas.tamSamSom === \"false\" ? false : respostas.tamSamSom,\n  pesquisaQualitativa: respostas.pesquisaQualitativa,\n  concorrentes: respostas.concorrentes,\n  persona: respostas.persona === \"true\" ? true : respostas.persona === \"false\" ? false : respostas.persona,\n  pitch: respostas.pitch === \"true\" ? true : respostas.pitch === \"false\" ? false : respostas.pitch,\n  programasAnteriores: respostas.programasAnteriores === \"true\" ? true : respostas.programasAnteriores === \"false\" ? false : respostas.programasAnteriores\n};\n\nconst output = {\n  nome: nome,\n  projeto: projeto,\n  email: email,\n  whatsapp: whatsapp,\n  pontuacao: Number(pontuacao),\n  resultado: resultado,\n  status: status,\n  respostas: respostasOutput,\n  perguntasMultiplaEscolha,\n  timestamp: new Date().toISOString(),\n  output: isComplete ? 'concluido' : 'em_andamento',\n  isComplete: isComplete,\n  dadosOriginais: dadosDoAgent\n};\n\nconsole.log('Output final:', JSON.stringify(output, null, 2));\n\nreturn { json: output };\n"},"id":"d5613043-206e-4917-8c62-49f4fdd24bed","name":"Process Qualification Data","type":"n8n-nodes-base.function","typeVersion":1,"position":[3100,980]},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"id":"e1f36a47-ec0f-494d-a8b2-2a1fc3fc763c","leftValue":"={{ $('Process Qualification Data').item.json.respostas.modeloNegocio }}","rightValue":"","operator":{"type":"boolean","operation":"notEmpty","singleValue":true}},{"id":"1df71386-7c94-4d26-88d1-43a70d190952","leftValue":"={{ $('Process Qualification Data').item.json.respostas.tamSamSom }}","rightValue":"","operator":{"type":"boolean","operation":"notEmpty","singleValue":true}},{"id":"8fa7b7e2-397e-4e22-b201-1aacb55396aa","leftValue":"={{ $('Process Qualification Data').item.json.dadosOriginais.respostas.pesquisaQualitativa }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}},{"id":"59724db7-fe96-4636-bd86-9d6b613f86ee","leftValue":"={{ $('Process Qualification Data').item.json.respostas.concorrentes }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}},{"id":"c2cbff30-8bb7-4a61-858a-21eab24f01dd","leftValue":"={{ $('Process Qualification Data').item.json.respostas.persona }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}},{"id":"6b7e9c94-4927-498c-8382-a59c9acf4c96","leftValue":"={{ $('Process Qualification Data').item.json.respostas.pitch }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}},{"id":"2795f379-0439-4930-bb7b-74435ca80ef9","leftValue":"={{ $('Process Qualification Data').item.json.respostas.programasAnteriores }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"id":"f177195b-dd1e-474e-ac28-876afa7b05fb","name":"Check Completion Status","type":"n8n-nodes-base.if","typeVersion":2,"position":[3980,1040]},{"parameters":{"tableId":"qualification_results","fieldsUi":{"fieldValues":[{"fieldId":"nome","fieldValue":"={{ $node[\"Process Qualification Data\"].json.nome }}"},{"fieldId":"projeto","fieldValue":"={{ $node[\"Process Qualification Data\"].json.projeto }}"},{"fieldId":"email","fieldValue":"={{ $node[\"Process Qualification Data\"].json.email }}"},{"fieldId":"whatsapp","fieldValue":"={{ $node[\"Process Qualification Data\"].json.whatsapp }}"},{"fieldId":"pontuacao","fieldValue":"={{ $node[\"Process Qualification Data\"].json.pontuacao }}"},{"fieldId":"resultado","fieldValue":"={{ $node[\"Process Qualification Data\"].json.resultado }}"},{"fieldId":"status","fieldValue":"={{ $node[\"Process Qualification Data\"].json.status }}"},{"fieldId":"data_qualificacao","fieldValue":"={{ $node[\"Process Qualification Data\"].json.timestamp }}"},{"fieldId":"respostas_json","fieldValue":"={{ JSON.stringify($node[\"Process Qualification Data\"].json.respostas) }}"},{"fieldId":"Phone","fieldValue":"={{ $('Dados').item.json.remoteJid }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[3740,960],"id":"c2e911b4-8e91-4971-9577-4bfac3cef6eb","name":"Supabase","credentials":{"supabaseApi":{"id":"OaqABPiG2T08H6kW","name":"Supabase account"}}},{"parameters":{"promptType":"define","text":"={{ $('Dados').item.json.conversation }}","hasOutputParser":true,"options":{"systemMessage":"=```\nData e horário atual: {{ new Date().toLocaleString('pt-BR', { timeZone: 'America/Sao_Paulo' }) }}\n\nVocê é um assistente da TecVitória - primeira incubadora de empresas de base tecnológica do Espírito Santo.\n\n##ENTRADA DO USUÁRIO: {{ $('Dados').item.json.conversation }}\n\n## OBJETIVO: Conduzir questionário de qualificação para interessados na incubação. Você deve processar APENAS a mensagem atual do usuário e responder adequadamente.\n\n## REGRAS CRÍTICAS:\n- RESPONDA APENAS À ENTRADA ATUAL DO USUÁRIO\n- NUNCA invente ou simule respostas do usuário\n- NUNCA preencha campos do JSON com dados fictícios ou inventados\n- SEMPRE mantenha campos vazios (\"\") até o usuário fornecer a informação real\n- NUNCA pule etapas ou responda perguntas que o usuário não fez\n- Uma pergunta por vez\n- Sempre exiba as opções numeradas exatamente como especificado\n- ESPERE a resposta do usuário antes de prosseguir\n- Valide email (formato email@valido.com) e whatsapp (formato 5511999999999)\n- Sempre retorne APENAS um objeto JSON válido\n- É OBRIGADO USAR EXATAMENTE AS FRASES ABAIXO E manter exatamente os EMOJIS nos textos.\n\n## FLUXO:\n1. Colete dados pessoais: nome completo, projeto, email, whatsapp, usando EXATAMENTE as perguntas abaixo a partir da segunda execução:\n    -🚀 *Agora, por favor, informe o nome do seu projeto ou ideia inovadora*:\n    -📧 *Informe seu e-mail para contato*:\\n\\n(Exemplo: email@valido.com):\n    -📱 *Agora, informe seu número de WhatsApp (com DDD e sem espaços)*:\\n\\n(Exemplo: 5511999999999): \n\nOBRIGATÓRIO: APÓS A COLETA DE INFORMAÇÕES, VÁ DIRETO PARA AS 7 PERGUNTAS ABAIXO, SEM INTRODUÇÕES OU INTERRUPÇÕES.\n\n2. Faça 7 perguntas com opções numeradas para o usuário escolher, descritas abaixo em PERGUNTAS EXATAS COM OPÇÕES. Faça as perguntas EXATAMENTE como descrito, não altere nada o texto. ATENÇÃO: É PROIBIDO RESPONDER AS RESPOSTAS DO USUÁRIO, SOMENTE FAÇA AS PERGUNTAS.\n3. NUNCA preencha as repostas do json no output antes de fazer as perguntas. Deixe sempre como vazio até fazer a pergunta.\n3. Para pesquisa qualitativa e mapeamento de concorrentes, há 3 opções\n4. Para outras perguntas, há 2 opções (Sim/Não)\n5. Usuário deve responder com o número da opção escolhida\n\n## PERGUNTAS EXATAS COM OPÇÕES:\n\n1) 📌 *Você já elaborou o Modelo de Negócio da sua ideia/projeto?*\\n\\n_O Modelo de Negócio é uma ferramenta que ajuda a estruturar de maneira objetiva e simples as principais áreas do seu projeto._\\n\\n( ) 1 - Sim\\n( ) 2 - Não\",\n\n2) 📊 *Você já analisou o tamanho de mercado do seu modelo de negócios e entendeu como vai gerar receitas?*\\n\\n_Essas métricas ajudam a estimar o potencial de alcance da sua solução._\\n\\n( ) 1 - Sim\\n( ) 2 - Não\",\n\n3) 🧪 *Você já realizou uma pesquisa qualitativa com potenciais clientes validando a dor que sua solução resolve?*\\n\\n_Aqui consideramos entrevistas, formulários ou qualquer forma de coleta estruturada, com dados organizados._\\n\\n( ) 1 - Sim, com dados organizados\\n( ) 2 - Informalmente, sem dados registrados\\n( ) 3 - Ainda não realizei\",\n\n4) 🕵️‍♂️ *Você já mapeou os principais concorrentes e o diferencial que sua solução tem?*\\n\\n_Ter o mapeamento de concorrentes e o comparativo em relação ao que tenho como diferencial deixa mais claro a proposta de valor para o mercado._\\n\\n( ) 1 - Sim, com dados organizados\\n( ) 2 - Fiz informalmente, mas sem dados registrados\\n( ) 3 - Ainda não realizei\",\n\n5) 🧠 *Você já estruturou a persona da sua solução?*\\n\\n_A persona é uma representação do cliente ideal e deixa claro quais os diferenciais que ele tem, além de ter mapeadas as dores e necessidades, facilitando a compreensão do diferencial e a criação de soluções mais eficazes._\\n\\n( ) 1 - Sim\\n( ) 2 - Não\",\n\n6) 🎤 *Você já possui uma apresentação da sua solução?*\\n\\n_A apresentação da sua solução tem mapeado problemas ou necessidades, dor que você resolve, diferenciais competitivos, tamanho do mercado._\\n\\n( ) 1 - Sim, já tenho esse pitch pronto e posso enviar\\n( ) 2 - Ainda não\",\n\n7) 📚 *Você já participou de algum outro programa ou trilha de desenvolvimento de projetos de inovação?*\\n\\n_Podem ser trilhas de incubação, pré-aceleração, aceleração ou alguma outra capacitação, treinamento ou mentoria relacionada ao desenvolvimento de projetos de inovação ou startups._\\n\\n( ) 1 - Sim\\n( ) 2 - Ainda não\"\n\n## MAPEAMENTO DE RESPOSTAS OBRIGATÓRIO\n- Perguntas 1, 2, 5: 1=\"true\", 2=\"false\"\n- Pergunta 3: 1=\"dados_organizados\", 2=\"informal\", 3=\"nao_realizei\"\n- Pergunta 4: 1=\"dados_organizados\", 2=\"informal\", 3=\"nao_realizei\"\n- Pergunta 6: 1=\"true\", 2=\"false\"\n- Pergunta 7: 1=\"true\", 2=\"false\"\n\nFORMATO DE SAÍDA:\n\n⚠️ CRÍTICO: Todos os campos devem permanecer vazios (\"\") até que o usuário forneça a informação correspondente. NUNCA invente dados.\n\n{\n  \"resposta\": \"Mensagem de resposta com quebras de linha usando \\\\n\",\n  \"nome\": \"Nome coletado ou string vazia\",\n  \"projeto\": \"Projeto coletado ou string vazia\", \n  \"email\": \"Email coletado ou string vazia\",\n  \"whatsapp\": \"WhatsApp coletado ou string vazia\",\n  \"respostas\": {\n    \"modeloNegocio\": \"\",\n    \"tamSamSom\": \"\",\n    \"pesquisaQualitativa\": \"\",\n    \"concorrentes\": \"\",\n    \"persona\": \"\",\n    \"pitch\": \"\",\n    \"programasAnteriores\": \"\"\n  }\n}\n\nPRIMEIRA EXECUÇÃO:\nSe esta for a primeira interação, retorne:\n{\n  \"resposta\": \"👋 Olá! Seja bem-vindo(a) à TecVitória!\\n\\nSomos a primeira incubadora de empresas de base tecnológica do Espírito Santo!\\n\\nNosso propósito é apoiar empreendedores como você a transformar ideias inovadoras em negócios sustentáveis e competitivos no mercado.\\n\\nPara entender se este é o momento ideal para você ser incubado ou se ainda vale investir na estruturação da sua ideia, vamos fazer algumas perguntas rápidas.\\n\\n🧭 Ao final, vamos te direcionar para o melhor caminho.\\n\\n✍ *Primeiro, informe seu nome completo:* \",\n  \"nome\": \"\",\n  \"projeto\": \"\",\n  \"email\": \"\",\n  \"whatsapp\": \"\",\n  \"respostas\": {\n    \"modeloNegocio\": \"\",\n    \"tamSamSom\": \"\",\n    \"pesquisaQualitativa\": \"\",\n    \"concorrentes\": \"\",\n    \"persona\": \"\",\n    \"pitch\": \"\",\n    \"programasAnteriores\": \"\"\n  }\n}\n\nIMPORTANTE: \n- Processe SOMENTE a entrada atual do usuário\n- NÃO invente conversas ou respostas\n- NÃO pule etapas do processo\n- AGUARDE cada resposta antes de continuar\n```"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2,"position":[2740,980],"id":"a77923cd-9a70-4db6-8f26-8408d8d5f72b","name":"AI Agent - TecVitória Qualification1","onError":"continueRegularOutput"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"b8f9168e-b0ef-4f26-ad3d-34c35e8937c0","leftValue":"={{ $json.pontuacao }}","rightValue":0,"operator":{"type":"number","operation":"equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[3280,980],"id":"d1c423c8-1f92-4c8b-9064-04e1203d4a54","name":"If"},{"parameters":{"operation":"update","tableId":"qualification_results","filters":{"conditions":[{"keyName":"whatsapp","condition":"eq","keyValue":"={{ $json.whatsapp }}"}]},"fieldsUi":{"fieldValues":[{"fieldId":"projeto","fieldValue":"={{ $('Process Qualification Data').item.json.projeto }}"},{"fieldId":"email","fieldValue":"={{ $('Process Qualification Data').item.json.email }}"},{"fieldId":"whatsapp","fieldValue":"={{ $('Process Qualification Data').item.json.whatsapp }}"},{"fieldId":"pontuacao","fieldValue":"={{ $('Process Qualification Data').item.json.pontuacao }}"},{"fieldId":"resultado","fieldValue":"={{ $('Process Qualification Data').item.json.resultado }}"},{"fieldId":"status","fieldValue":"={{ $('Process Qualification Data').item.json.status }}"},{"fieldId":"data_qualificacao","fieldValue":"={{ $('Process Qualification Data').item.json.timestamp }}"},{"fieldId":"respostas_json","fieldValue":"={{ $('Process Qualification Data').item.json.respostas }}"},{"fieldId":"nome","fieldValue":"={{ $json.nome }}"},{"fieldId":"Phone","fieldValue":"={{ $('Dados').item.json.remoteJid }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[3740,1240],"id":"0ceaf2f1-2bc3-46ea-b9bb-6e4cfd50a1d5","name":"Supabase1","alwaysOutputData":true,"credentials":{"supabaseApi":{"id":"OaqABPiG2T08H6kW","name":"Supabase account"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"084197cb-13c7-4a0b-856e-ae31242120d4","leftValue":"={{ $json.pontuacao }}","rightValue":1,"operator":{"type":"number","operation":"equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[3540,1100],"id":"3ad2cdcc-54e1-4282-bb51-9871d45037ad","name":"If1"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.outputParserAutofixing","typeVersion":1,"position":[3000,1180],"id":"b16b0c57-06a8-40bc-bd7a-6de42df42b6a","name":"Auto-fixing Output Parser"},{"parameters":{"jsonSchemaExample":"{\n  \"resposta\": \"Mensagem de resposta ou próxima pergunta\",\n  \"nome\": \"Nome coletado ou vazio\",\n  \"projeto\": \"Projeto coletado ou vazio\",\n  \"email\": \"Email coletado ou vazio\",\n  \"whatsapp\": \"WhatsApp coletado ou vazio\",\n  \"respostas\": {\n    \"modeloNegocio\": \"\",\n    \"tamSamSom\": \"\",\n    \"pesquisaQualitativa\": \"\",\n    \"concorrentes\": \"\",\n    \"persona\": \"\",\n    \"pitch\": \"\",\n    \"programasAnteriores\": \"\"\n  }\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[3100,1300],"id":"13003736-094e-47d7-b6a6-39b529a09ae9","name":"Structured Output Parser"},{"parameters":{"jsCode":"// Garante que só o primeiro item seja retornado como array com 1 item\nreturn [ { json: items[0].json } ];"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[4600,840],"id":"d62bc3fe-3561-4353-80c1-6d4652cf527a","name":"Code","disabled":true},{"parameters":{"jsCode":"// Garante que só o primeiro item seja retornado como array com 1 item\nreturn [ { json: items[0].json } ];"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[4600,1060],"id":"ae3ac3f4-bfed-4be7-a0c1-beb99244e0dd","name":"Code1","disabled":true},{"parameters":{"jsCode":"// Garante que só o primeiro item seja retornado como array com 1 item\nreturn [ { json: items[0].json } ];"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[4600,1300],"id":"4e8ae779-9392-488b-82c4-834ae91a2f4a","name":"Code2","disabled":true},{"parameters":{"jsCode":"// Garante que só o primeiro item seja retornado como array com 1 item\nreturn [ { json: items[0].json } ];"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[4260,1640],"id":"4df97a4b-cc92-4e10-b22e-53d7ad636654","name":"Code3","disabled":true},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ $('Process Qualification Data').item.json.status }}","rightValue":"aprovado_incubacao","operator":{"type":"string","operation":"equals"},"id":"8a842253-023e-4ec6-b02b-e6636c8bb871"}],"combinator":"and"},"renameOutput":true,"outputKey":"Incubação"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"40c9068e-6f64-44e4-ab47-53c346a9daf1","leftValue":"={{ $('Process Qualification Data').item.json.status }}","rightValue":"trilha_avancada","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"Avançada"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"adf4ac5c-bdae-490f-9775-c1da05e11cf0","leftValue":"={{ $('Process Qualification Data').item.json.status }}","rightValue":"trilha_inicial","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"Inicial"}]},"options":{}},"type":"n8n-nodes-base.switch","typeVersion":3.2,"position":[4260,1060],"id":"049e272c-bd4c-4f39-bcdf-23548ed31416","name":"Switch"},{"parameters":{"httpMethod":"POST","path":"incubadora","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2,"position":[-580,1000],"id":"6b70c923-0d05-4725-b823-827cf232e09a","name":"Webhook","webhookId":"1b939bce-06a9-4899-99aa-3539e0c8bceb"},{"parameters":{"assignments":{"assignments":[{"id":"2911e082-e712-4b85-bcf7-611f60d1559f","name":"remoteJid","value":"={{ $json.content.remoteJid }}","type":"string"},{"id":"f2af5f89-8957-4811-9839-8ef571b38e5c","name":"fromMe","value":"={{ $json.content.fromMe }}","type":"boolean"},{"id":"16a9c5c0-5a35-4db2-ab94-ef251115696f","name":"conversation","value":"={{ $json.content.conversation }}","type":"string"},{"id":"20937be5-8999-4d95-91cb-5aa9490f166c","name":"date_time","value":"={{ $json.content.date_time }}","type":"string"},{"id":"fa5a0f16-b265-40ab-9299-135659bbf90e","name":"messageType","value":"={{ $json.content.messageType }}","type":"string"},{"id":"95ca6185-7794-4411-82c5-d30676a6ca52","name":"evo.instance","value":"={{ $json.content.evo.instance }}","type":"string"},{"id":"66fcd40d-88da-4117-958d-7b4a29454136","name":"evo.server_url","value":"={{ $json.content.evo.server_url }}","type":"string"},{"id":"477ee9d8-59d3-4dd4-9eab-038367517cb1","name":"evo.apikey","value":"={{ $json.content.evo.apikey }}","type":"string"},{"id":"89c694a3-3a94-4bf2-8d8d-016bafa3040e","name":"time_out","value":60,"type":"number"},{"id":"95eb2166-9205-4b79-ab5d-0c98fc3969ee","name":"client","value":"","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[400,1000],"id":"3e42c69f-71b6-4890-8740-8e67135f75f4","name":"Dados"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":2},"conditions":[{"id":"dcddc350-6002-4f96-997d-90f714bedbcf","leftValue":"={{ $json.perguntasMultiplaEscolha[0] }}","rightValue":"[]","operator":{"type":"string","operation":"empty","singleValue":true}}],"combinator":"and"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[3540,520],"id":"70c4df8e-0e62-4e01-80a2-facd393be60c","name":"If3"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.chatTrigger","typeVersion":1.1,"position":[1940,1520],"id":"456016ee-b714-465d-95bc-a3ea8e579532","name":"When chat message received","webhookId":"eca83702-4f56-4eb9-811c-63ebb8ece0fe"},{"parameters":{"assignments":{"assignments":[{"id":"2911e082-e712-4b85-bcf7-611f60d1559f","name":"remoteJid","value":"=5511994774816","type":"string"},{"id":"f2af5f89-8957-4811-9839-8ef571b38e5c","name":"fromMe","value":"={{ $json.body.data.key.fromMe }}","type":"boolean"},{"id":"16a9c5c0-5a35-4db2-ab94-ef251115696f","name":"conversation","value":"={{ $json.body.data.message.conversation }}","type":"string"},{"id":"20937be5-8999-4d95-91cb-5aa9490f166c","name":"date_time","value":"={{ $json.body.date_time }}","type":"string"},{"id":"fa5a0f16-b265-40ab-9299-135659bbf90e","name":"messageType","value":"={{ $json.body.data.messageType }}","type":"string"},{"id":"95ca6185-7794-4411-82c5-d30676a6ca52","name":"evo.instance","value":"=Assistente Naweb","type":"string"},{"id":"66fcd40d-88da-4117-958d-7b4a29454136","name":"evo.server_url","value":"={{ $json.body.server_url }}","type":"string"},{"id":"477ee9d8-59d3-4dd4-9eab-038367517cb1","name":"evo.apikey","value":"={{ $json.body.apikey }}","type":"string"},{"id":"89c694a3-3a94-4bf2-8d8d-016bafa3040e","name":"time_out","value":60,"type":"number"},{"id":"95eb2166-9205-4b79-ab5d-0c98fc3969ee","name":"client","value":"","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[2420,1520],"id":"1daa8583-3f67-4678-b31b-7a1a44f7306f","name":"Dados1"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"9eb6b97d-d4fa-4259-876b-39e38ce58768","leftValue":"={{ $json.chatInput }}","rightValue":"=#apagarmemoria","operator":{"type":"string","operation":"contains"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[2160,1520],"id":"55b3db45-0a95-488c-b987-52a3c3b4ef27","name":"If6"},{"parameters":{"method":"POST","url":"=https://api.z-api.io/instances/3E34B1796728001766CE728A74374CC1/token/739DBE0A3929A921D34BED2D/send-link","authentication":"predefinedCredentialType","nodeCredentialType":"zapiApi","sendBody":true,"bodyParameters":{"parameters":[{"name":"phone","value":"={{ $('Dados').first().json.remoteJid }}"},{"name":"message","value":"=Análise concluída!\n\nParabéns! 🎉 \n\nVocê já possui todos os requisitos que analisamos para o processo de incubação da TecVitória. Isso mostra que sua ideia passou por etapas fundamentais de estruturação e validação no mercado, o que aumenta muito as chances de sucesso na jornada empreendedora.\nNosso time está pronto para te acompanhar no próximo passo.\n\n👉 Inscreva-se agora no nosso edital de fluxo contínuo de incubação pelo site."},{"name":"image","value":"https://tecvitoria.com.br/wp-content/uploads/2025/06/incubacao-1.jpg"},{"name":"linkUrl","value":"https://incubacao.tecvitoria.com.br/"},{"name":"title","value":"Tecvitoria"},{"name":"linkDescription","value":"Inscreva-se na Incubação"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[4840,840],"id":"fb973aee-1e61-4f4b-898a-fdff6cd5994f","name":"Aprovado para Incubação","credentials":{"zapiApi":{"id":"Mvy87oy1GvsL7pPH","name":"Z-API account"}}},{"parameters":{"method":"POST","url":"=https://api.z-api.io/instances/3E34B1796728001766CE728A74374CC1/token/739DBE0A3929A921D34BED2D/send-link","authentication":"predefinedCredentialType","nodeCredentialType":"zapiApi","sendBody":true,"bodyParameters":{"parameters":[{"name":"phone","value":"={{ $('Dados').first().json.remoteJid }}"},{"name":"message","value":"=Análise concluída!\n\nVocê já avançou bastante na estruturação do seu projeto – isso é excelente! 🎯\n\nNo entanto, ainda há pontos importantes a desenvolver para garantir uma análise mais robusta no processo de incubação.\n\n👉 Recomendamos que você participe da nossa Trilha da Inovação, uma jornada 100% online e gratuita que vai te apoiar no preenchimento dessas lacunas com conteúdos práticos e direcionados.\nVocê receberá acesso à nossa plataforma Startec, onde poderá se cadastrar e acessar os conteúdos necessários para estruturar melhor a sua ideia.\n\nDurante a trilha, você também terá reuniões com o nosso time de incubação, que irá acompanhar de perto sua evolução.\n\nClique para começar a trilha, informe o voucher “TRILHAINOVA”:\n"},{"name":"image","value":"https://tecvitoria.com.br/wp-content/uploads/2025/06/Startec.jpg"},{"name":"linkUrl","value":"https://startec.tecvitoria.com.br/convite/trilha-da-inovacao-boot/01jyhmjhc9f3gynqd71pp956fv"},{"name":"title","value":"Tecvitoria"},{"name":"linkDescription","value":"Inscreva-se na Startec"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[4840,1060],"id":"9f7c30f6-47ae-4ea4-8e9c-9b7ea22c7843","name":"Aprovado para Startec","credentials":{"zapiApi":{"id":"Mvy87oy1GvsL7pPH","name":"Z-API account"}}},{"parameters":{"method":"POST","url":"=https://api.z-api.io/instances/3E34B1796728001766CE728A74374CC1/token/739DBE0A3929A921D34BED2D/send-link","authentication":"predefinedCredentialType","nodeCredentialType":"zapiApi","sendBody":true,"bodyParameters":{"parameters":[{"name":"phone","value":"={{ $('Dados').first().json.remoteJid }}"},{"name":"message","value":"=Análise concluída!\n\nSeu projeto está em uma fase inicial – e isso é totalmente normal. A inovação começa com uma boa ideia, mas precisa de organização e validação para gerar impacto real.\n\nO melhor caminho agora é participar da nossa Trilha da Inovação – um programa online e gratuito que vai te ensinar a aplicar ferramentas como Lean Canvas, mapa de empatia, pesquisa com clientes e construção de pitch.\n\n👉 Acesse agora o site e se cadastre: \n"},{"name":"image","value":"https://tecvitoria.com.br/wp-content/uploads/2025/06/logo-trilha-inovacao-tecvitoria.jpg"},{"name":"linkUrl","value":"https://trilhadainovacao.tecvitoria.com.br/"},{"name":"title","value":"Tecvitoria"},{"name":"linkDescription","value":"Acesse a Trilha da Inovação"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[4860,1300],"id":"ee123b9a-a47f-4c5f-8291-0adb200f78c5","name":"Inscrição Trilha da Inovação","credentials":{"zapiApi":{"id":"Mvy87oy1GvsL7pPH","name":"Z-API account"}}},{"parameters":{"content":"RESPOSTAS FINAIS Z-API","height":680,"width":1520,"color":5},"type":"n8n-nodes-base.stickyNote","position":[4200,800],"typeVersion":1,"id":"10adb544-ab7a-437e-aeb0-83de1951f832","name":"Sticky Note"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":2},"conditions":[{"id":"d5427626-a354-43ed-8ac1-0fc43011634b","leftValue":"={{ $('Process Qualification Data').first().json.dadosOriginais.resposta }}","rightValue":"=realizou uma pesquisa qualitativa","operator":{"type":"string","operation":"contains"}},{"id":"dfbf4d37-8fa4-486e-b4a6-f1058e1148c2","leftValue":"={{ $('Process Qualification Data').first().json.dadosOriginais.resposta }}","rightValue":"mapeou os principais concorrentes","operator":{"type":"string","operation":"contains"}}],"combinator":"or"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[4400,1640],"id":"2fb380e3-8f28-4b9d-a4ae-6ef30d269567","name":"Pergunta 3?"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"78924e4f-69de-43db-89b7-c6ae366afe99","leftValue":"={{ $('Process Qualification Data').first().json.dadosOriginais.resposta }}","rightValue":"sua solução tem mapeado problemas","operator":{"type":"string","operation":"contains"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[4520,1920],"id":"0b996ddd-92a3-455c-9dbd-180610cafb3c","name":"Pergunta 4?"},{"parameters":{"method":"POST","url":"=https://api.z-api.io/instances/3E34B1796728001766CE728A74374CC1/token/739DBE0A3929A921D34BED2D/send-text","authentication":"predefinedCredentialType","nodeCredentialType":"zapiApi","sendBody":true,"bodyParameters":{"parameters":[{"name":"phone","value":"={{ $('Dados').item.json.remoteJid }}"},{"name":"message","value":"={{ $json.dadosOriginais.resposta }}"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[3860,500],"id":"cac319b8-6a0f-454a-b1bd-7b5cd45b1258","name":"Z-API - Dados","retryOnFail":true,"credentials":{"zapiApi":{"id":"Mvy87oy1GvsL7pPH","name":"Z-API account"}},"onError":"continueErrorOutput"},{"parameters":{"method":"POST","url":"=https://api.z-api.io/instances/3E34B1796728001766CE728A74374CC1/token/739DBE0A3929A921D34BED2D/send-option-list","authentication":"predefinedCredentialType","nodeCredentialType":"zapiApi","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"phone\": \"{{ $('Dados').first().json.remoteJid }}\",\n  \"message\": \"{{ $('Process Qualification Data').item.json.perguntasMultiplaEscolha[0].pergunta }}\",\n  \"optionList\": {\n    \"buttonLabel\": \"Opções\",\n    \"options\": [\n      {\n        \"id\": \"1\",\n        \"title\": \"{{ $('Process Qualification Data').first().json.perguntasMultiplaEscolha[0].opcoes[0].replace(/^\\d+\\s*[-–]?\\s*/g, '').trim() }}\"\n      },\n      {\n        \"id\": \"2\",\n        \"title\": \"{{ $('Process Qualification Data').first().json.perguntasMultiplaEscolha[0].opcoes[1].replace(/^\\d+\\s*[-–]?\\s*/g, '').trim() }}\"\n      },\n     {\n        \"id\": \"3\",\n        \"title\": \"{{ $('Process Qualification Data').first().json.perguntasMultiplaEscolha[0].opcoes[2].replace(/^\\d+\\s*[-–]?\\s*/g, '').trim() }}\"\n      }\n    ]\n  }\n}\n\n","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[4880,1580],"id":"f36e740c-9a55-4907-94f7-accb8d257b60","name":"Z-API - Lista - Pergunta 3","retryOnFail":true,"credentials":{"zapiApi":{"id":"Mvy87oy1GvsL7pPH","name":"Z-API account"}},"onError":"continueErrorOutput"},{"parameters":{"method":"POST","url":"=https://api.z-api.io/instances/3E34B1796728001766CE728A74374CC1/token/739DBE0A3929A921D34BED2D/send-button-list","authentication":"predefinedCredentialType","nodeCredentialType":"zapiApi","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"phone\": \"{{ $('Dados').item.json.remoteJid }}\",\n  \"message\": \"{{ $json.perguntasMultiplaEscolha[0].pergunta }}\",\n  \"buttonList\": {\n    \"buttons\": [\n      {\n        \"id\": \"1\",\n        \"label\": \"{{ $('Process Qualification Data').item.json.perguntasMultiplaEscolha[0].opcoes[0].replace(/^\\d+\\s*[-–]?\\s*/g, '') }}\"\n      },\n      {\n        \"id\": \"2\",\n        \"label\": \"{{ $('Process Qualification Data').item.json.perguntasMultiplaEscolha[0].opcoes[1].replace(/^\\d+\\s*[-–]?\\s*/g, '') }}\"\n      }\n\n    ]\n  }\n}\n","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[3880,660],"id":"70e73743-67b4-42c9-ba28-7b0387aafed4","name":"Z-API - Botões Pergunta 1","retryOnFail":true,"maxTries":5,"credentials":{"zapiApi":{"id":"Mvy87oy1GvsL7pPH","name":"Z-API account"}},"onError":"continueErrorOutput"},{"parameters":{"method":"POST","url":"=https://api.z-api.io/instances/3E34B1796728001766CE728A74374CC1/token/739DBE0A3929A921D34BED2D/send-button-list","authentication":"predefinedCredentialType","nodeCredentialType":"zapiApi","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"phone\": \"{{ $('Dados').first().json.remoteJid }}\",\n  \"message\": \"{{ $('Process Qualification Data').item.json.perguntasMultiplaEscolha[0].pergunta }}\",\n  \"buttonList\": {\n    \"buttons\": [\n      {\n        \"id\": \"1\",\n        \"label\": \"{{ $('Process Qualification Data').first().json.perguntasMultiplaEscolha[0].opcoes[0].replace(/^\\d+\\s*[-–]?\\s*/g, '') }}\"\n      },\n      {\n        \"id\": \"2\",\n        \"label\": \"{{ $('Process Qualification Data').first().json.perguntasMultiplaEscolha[0].opcoes[1].replace(/^\\d+\\s*[-–]?\\s*/g, '') }}\"\n      }\n    ]\n  }\n}\n\n\n\n","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[4880,2000],"id":"1dea171e-b913-44e3-8bad-ebda1631e0b4","name":"Z-API - Botões Perguntas 2, 5, 6, 7","retryOnFail":true,"credentials":{"zapiApi":{"id":"Mvy87oy1GvsL7pPH","name":"Z-API account"}},"onError":"continueErrorOutput"},{"parameters":{"method":"POST","url":"=https://api.z-api.io/instances/3E34B1796728001766CE728A74374CC1/token/739DBE0A3929A921D34BED2D/send-option-list","authentication":"predefinedCredentialType","nodeCredentialType":"zapiApi","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"phone\": \"{{ $('Dados').first().json.remoteJid }}\",\n  \"message\": \"{{ $('Process Qualification Data').item.json.perguntasMultiplaEscolha[0].pergunta }}\",\n  \"optionList\": {\n    \"buttonLabel\": \"Opções\",\n    \"options\": [\n      {\n        \"id\": \"1\",\n        \"title\": \"Sim, tenho o pitch e posso enviar \"\n      },\n      {\n        \"id\": \"2\",\n        \"title\": \"Ainda não\"\n      }\n    ]\n  }\n}\n\n","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[4880,1780],"id":"c5a6d4ca-4faa-4610-87fa-542594a8c16f","name":"Z-API Lista Pergunta 4","retryOnFail":true,"credentials":{"zapiApi":{"id":"Mvy87oy1GvsL7pPH","name":"Z-API account"}},"onError":"continueErrorOutput"},{"parameters":{"content":"ENTRADA DE DADOS","height":480,"width":1640,"color":3},"type":"n8n-nodes-base.stickyNote","position":[-660,820],"typeVersion":1,"id":"2d5e1d24-95ed-41b0-a0cc-ee7e9ffe125f","name":"Sticky Note1"},{"parameters":{"content":"AGENTE PROCESSADOR DE PERGUNTAS","height":580,"width":840,"color":4},"type":"n8n-nodes-base.stickyNote","position":[2420,900],"typeVersion":1,"id":"ada629e0-57e5-436d-bcee-b759a0572e3f","name":"Sticky Note2"},{"parameters":{"content":"PERGUNTAS DE QUALIFICAÇÃO","height":660,"width":840,"color":5},"type":"n8n-nodes-base.stickyNote","position":[4200,1540],"typeVersion":1,"id":"fa342a5a-a2b5-4e31-a355-048576b54e83","name":"Sticky Note3"},{"parameters":{"content":"BANCO DE DADOS","height":580,"width":680,"color":7},"type":"n8n-nodes-base.stickyNote","position":[3480,900],"typeVersion":1,"id":"83543fff-6bde-4ec9-abcc-24d5787cda3e","name":"Sticky Note4"},{"parameters":{"content":"IDENTIFICAÇÃO","height":440,"width":680,"color":5},"type":"n8n-nodes-base.stickyNote","position":[3500,420],"typeVersion":1,"id":"d1f2ca8e-fba5-4db1-ad6e-e0c9550de384","name":"Sticky Note5"},{"parameters":{"content":"TESTES","height":300,"width":760},"type":"n8n-nodes-base.stickyNote","position":[1840,1420],"typeVersion":1,"id":"3d4319b6-929b-4bf6-bdc3-a03a9a78645d","name":"Sticky Note6"},{"parameters":{"content":"VERIFICAR CADASTRO","height":500,"width":760,"color":6},"type":"n8n-nodes-base.stickyNote","position":[1840,900],"typeVersion":1,"id":"55240ffb-e846-41b4-b33a-868e965f61d9","name":"Sticky Note7"},{"parameters":{"operation":"get","tableId":"qualification_results","filters":{"conditions":[{"keyName":"whatsapp","keyValue":"={{ $json.conversation }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[2120,1220],"id":"94354974-fb78-407b-af67-e179e8ac56e6","name":"Supabase6","alwaysOutputData":true,"credentials":{"supabaseApi":{"id":"OaqABPiG2T08H6kW","name":"Supabase account"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"ea9512f2-e67c-4ef7-992f-893c75cfee8f","leftValue":"={{ $json.fromMe }}","rightValue":"","operator":{"type":"boolean","operation":"true","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[2360,1220],"id":"c586d73c-b713-4e1a-8061-9312af7ed2fd","name":"If2"},{"parameters":{"operation":"getAll","tableId":"qualification_results","filters":{"conditions":[{"keyName":"Phone","condition":"eq","keyValue":"={{ $json.remoteJid }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[580,1000],"id":"c1ac883a-b56a-4c40-8ae5-2d854b980a28","name":"Get many rows","alwaysOutputData":true,"credentials":{"supabaseApi":{"id":"OaqABPiG2T08H6kW","name":"Supabase account"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"07aec2b3-5af9-4d67-a3d5-53abf0a91525","leftValue":"={{ $json.Phone }}","rightValue":"","operator":{"type":"string","operation":"exists","singleValue":true}},{"id":"39a6ef91-8ad2-4859-9f3f-89d9ced25556","leftValue":"={{ $json.resultado }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1900,1100],"id":"ce109e70-dba1-42e2-a9f2-0967dd8d0ab0","name":"If5"},{"parameters":{"method":"POST","url":"=https://api.z-api.io/instances/3E34B1796728001766CE728A74374CC1/token/739DBE0A3929A921D34BED2D/send-text","authentication":"predefinedCredentialType","nodeCredentialType":"zapiApi","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"phone\": \"{{ $('Dados').item.json.remoteJid }}\",\n  \"message\": \"{{ $json.nome }}, verificamos que seu WhatsApp já tem um cadastro aqui. Você deseja refazer o questionário?\",\n  \"buttonList\": {\n    \"buttons\": [\n      {\n        \"id\": \"1\",\n        \"label\": \"Refazer\"\n      },\n      {\n        \"id\": \"2\",\n        \"label\": \"Manter o atual\"\n      }\n\n    ]\n  }\n}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[2120,940],"id":"2761f3a0-f5c2-4cf8-9d8e-e45385a3bc58","name":"Recomeçar","credentials":{"zapiApi":{"id":"Mvy87oy1GvsL7pPH","name":"Z-API account"}}},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ $('Dados').item.json.conversation }}","rightValue":"Refazer","operator":{"type":"string","operation":"equals"},"id":"468f591d-149a-4345-ace8-22026944b274"}],"combinator":"and"},"renameOutput":true,"outputKey":"Refazer"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"cb642314-8dd5-44ac-b9a0-8aa3c1f9f979","leftValue":"={{ !$('Dados').item.json.conversation.match(/\\b(Refazer|Manter o atual|[12345])\\b/i) }}","rightValue":"Manter o atual Refazer","operator":{"type":"boolean","operation":"true","singleValue":true}}],"combinator":"and"},"renameOutput":true,"outputKey":"Continua"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"1fec5448-f22f-44d8-9fdd-72cc9a136087","leftValue":"={{ $('Dados').item.json.conversation }}","rightValue":"Manter o atual","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"Manter o atual"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"214e9ccc-908e-4a93-9bc6-b61dfa258833","leftValue":"={{ [1, 2, 3, 4, 5].includes(+$('Dados').item.json.conversation) }}","rightValue":"","operator":{"type":"boolean","operation":"true","singleValue":true}}],"combinator":"and"},"renameOutput":true,"outputKey":"Feedback"}]},"options":{}},"type":"n8n-nodes-base.switch","typeVersion":3.2,"position":[760,980],"id":"a3a98979-0574-415d-9f4a-86aa2b6f7ac0","name":"Switch2"},{"parameters":{"method":"POST","url":"=https://api.z-api.io/instances/3E34B1796728001766CE728A74374CC1/token/739DBE0A3929A921D34BED2D/send-link","authentication":"predefinedCredentialType","nodeCredentialType":"zapiApi","sendBody":true,"bodyParameters":{"parameters":[{"name":"phone","value":"={{ $('Dados').first().json.remoteJid }}"},{"name":"message","value":"=Perfeito {{ $json.nome }}!\nRelembrando, você foi {{ $json.resultado.toLowerCase() }}.\n\nClique no link abaixo, caso não tenha feito."},{"name":"image","value":"={{    $json.resultado.toLowerCase().trim() === 'aprovado para incubação'     ? 'https://tecvitoria.com.br/wp-content/uploads/2025/06/incubacao-1.jpg'     : $json.resultado.toLowerCase().trim() === 'trilha avançada'       ? 'https://tecvitoria.com.br/wp-content/uploads/2025/06/Startec.jpg'       : $json.resultado.toLowerCase().trim() === 'trilha inicial'         ? 'https://tecvitoria.com.br/wp-content/uploads/2025/06/logo-trilha-inovacao-tecvitoria.jpg'         : '' }}"},{"name":"linkUrl","value":"={{ \n  $json.resultado === 'Aprovado para Incubação' \n    ? 'https://incubacao.tecvitoria.com.br/' \n    : $json.resultado === 'Trilha Avançada' \n      ? 'https://startec.tecvitoria.com.br/convite/trilha-da-inovacao-boot/01jyhmjhc9f3gynqd71pp956fv' \n      : $json.resultado === 'Trilha Inicial' \n        ? 'https://trilhadainovacao.tecvitoria.com.br/' \n        : ''\n}}"},{"name":"title","value":"Tecvitoria"},{"name":"linkDescription","value":"Inscreva-se na Incubação"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1200,1220],"id":"e36e967a-1d13-4e39-b4f7-bf7096c565b3","name":"Aprovado para Incubação1","credentials":{"zapiApi":{"id":"Mvy87oy1GvsL7pPH","name":"Z-API account"}}},{"parameters":{"method":"POST","url":"=https://api.z-api.io/instances/3E34B1796728001766CE728A74374CC1/token/739DBE0A3929A921D34BED2D/send-text","authentication":"predefinedCredentialType","nodeCredentialType":"zapiApi","sendBody":true,"bodyParameters":{"parameters":[{"name":"phone","value":"={{ $('Dados').item.json.remoteJid }}"},{"name":"message","value":"=Perfeito {{ $json.nome }}, após essa mensagem, seu questionário será reiniciado"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1200,480],"id":"574899dc-75c6-4890-af05-165496b26fc3","name":"Z-API - Dados1","credentials":{"zapiApi":{"id":"Mvy87oy1GvsL7pPH","name":"Z-API account"}}},{"parameters":{"operation":"delete","tableId":"qualification_results","filters":{"conditions":[{"keyName":"Phone","condition":"eq","keyValue":"={{ $('Dados').item.json.remoteJid }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[1640,480],"id":"20cca682-2d68-4a39-b1dd-ea44e4218880","name":"Supabase4","credentials":{"supabaseApi":{"id":"OaqABPiG2T08H6kW","name":"Supabase account"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":2},"conditions":[{"id":"9eb6b97d-d4fa-4259-876b-39e38ce58768","leftValue":"={{ $('Dados').item.json.conversation }}","rightValue":"=#apagarmemoria","operator":{"type":"string","operation":"contains"}}],"combinator":"and"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1120,980],"id":"9218c8e4-f75b-4a06-84ab-373bfb9f753b","name":"If7"},{"parameters":{"operation":"delete","tableId":"qualification_results","filters":{"conditions":[{"keyName":"Phone","condition":"eq","keyValue":"={{ $('Dados').item.json.remoteJid }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[1480,680],"id":"f26b01f2-e195-4bd3-b164-ffec85e0b3cf","name":"Supabase5","alwaysOutputData":true,"credentials":{"supabaseApi":{"id":"OaqABPiG2T08H6kW","name":"Supabase account"}}},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[5040,840],"id":"108e213d-c0e5-4174-8ab5-c5ef9a716fc1","name":"Wait","webhookId":"6455d232-1dfe-4332-8665-7eb22955fb2f","disabled":true},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[5040,1060],"id":"24bd4515-3c06-49d6-b4e8-beb783ffc2a8","name":"Wait1","webhookId":"04ffe932-3c7a-4acb-8572-8772e6039ce0","disabled":true},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[5040,1300],"id":"23c0017b-7a4f-4ae0-ba08-f0423ec58cb9","name":"Wait2","webhookId":"191e0244-6535-44a2-9279-7384458b8d30","disabled":true},{"parameters":{"promptType":"define","text":"=OBJETIVO\nVocê está recebendo essa pontuação {{ $('Dados').item.json.conversation }} que pode ir de 1 a 5.\n\nBaseando-se nela, quero que você responda EXATAMENTE com as mensagens abaixo, de acordo com a pontuação a seguinte:\n\nAÇÃO:\n\nSE {{ $('Dados').item.json.conversation }} estiver entre 1 e 3, responda: 😞 Puxa, que pena {{ $json.nome }}, deixe opinião para que possamos melhorar o atendimento! Obrigado!\n\nSE {{ $('Dados').item.json.conversation }} estiver entre 4 e 5, responda: 🥳 Que ótimo {{ $json.nome }}! Ficamos felizes em saber que ajudamos!\n\nObrigado!\n\nATENÇÃO:\nForneça apenas UMA RESPOSTA, sem explicação nem nada, somente a resposta.","options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2,"position":[1120,1480],"id":"1e692cd0-f56b-43f1-86a5-bf0a21100036","name":"AI Agent"},{"parameters":{"model":{"__rl":true,"value":"gpt-4.1","mode":"list","cachedResultName":"gpt-4.1"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[1080,1680],"id":"03516f95-926b-4909-aaf6-0cdee9a9deb6","name":"OpenAI Chat Model1","credentials":{"openAiApi":{"id":"uu3Gb39bRtnzP2bu","name":"OpenAI Andre"}}},{"parameters":{"method":"POST","url":"=https://api.z-api.io/instances/3E34B1796728001766CE728A74374CC1/token/739DBE0A3929A921D34BED2D/send-option-list","authentication":"predefinedCredentialType","nodeCredentialType":"zapiApi","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"phone\": \"{{ $('Dados').first().json.remoteJid }}\",\n  \"message\": \"Antes de finalizar, gostaria de saber a sua opinião sobre a nossa conversa:\\n\\nDe 1 a 5, qual nota você acha que meu *atendimento* pelo *WhatsApp* merece?\\n\\n1 🟥🟥🟧🟨🟩 5\",\n  \"optionList\": {\n    \"buttonLabel\": \"Opções\",\n    \"options\": [\n      {\n        \"id\": \"1\",\n        \"title\": \"1\"\n      },\n      {\n        \"id\": \"2\",\n        \"title\": \"2\"\n      },\n{\n        \"id\": \"3\",\n        \"title\": \"3\"\n      },\n{\n        \"id\": \"4\",\n        \"title\": \"4\"\n      },\n     {\n        \"id\": \"5\",\n        \"title\": \"5\"\n      }\n    ]\n  }\n}\n\n","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[5280,1060],"id":"3a79787d-4e28-410f-9363-df831f1e8dd3","name":"Feedback","credentials":{"zapiApi":{"id":"Mvy87oy1GvsL7pPH","name":"Z-API account"}}},{"parameters":{"method":"POST","url":"=https://api.z-api.io/instances/3E34B1796728001766CE728A74374CC1/token/739DBE0A3929A921D34BED2D/send-text","authentication":"predefinedCredentialType","nodeCredentialType":"zapiApi","sendBody":true,"bodyParameters":{"parameters":[{"name":"phone","value":"={{ $('Dados').item.json.remoteJid }}"},{"name":"message","value":"={{ $json.output }}"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1600,1540],"id":"766a35a5-d6a3-4e3f-bd92-76c125d0aae4","name":"Z-API - Dados2","credentials":{"zapiApi":{"id":"Mvy87oy1GvsL7pPH","name":"Z-API account"}}},{"parameters":{"content":"Feedback\n","height":400,"width":780},"type":"n8n-nodes-base.stickyNote","position":[1020,1420],"typeVersion":1,"id":"72b1cf06-aef2-428a-90ed-792403be586a","name":"Sticky Note8"},{"parameters":{"content":"APAGAR MEMÓRIA","height":480,"width":720},"type":"n8n-nodes-base.stickyNote","position":[1100,400],"typeVersion":1,"id":"f25fae86-77f0-4425-9eb0-4bff15e64790","name":"Sticky Note9"},{"parameters":{"sessionIdType":"customKey","sessionKey":"={{ $('Dados').first().json.remoteJid }}","tableName":"conversas_candidatos_incubacao"},"type":"@n8n/n8n-nodes-langchain.memoryPostgresChat","typeVersion":1.3,"position":[2820,1180],"id":"336054ee-6d9e-42f2-b636-a2d66641fd96","name":"Postgres Chat Memory","credentials":{"postgres":{"id":"QZR6jt2yEz1JBvqt","name":"Postgres account"}}},{"parameters":{"operation":"deleteTable","schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"conversas_candidatos_incubacao","mode":"name"},"options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[1420,480],"id":"395057c2-402f-42c3-b32e-fa35365c4e50","name":"Delete table or rows","credentials":{"postgres":{"id":"QZR6jt2yEz1JBvqt","name":"Postgres account"}}},{"parameters":{"operation":"deleteTable","schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"conversas_candidatos_incubacao","mode":"name"},"options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[1300,680],"id":"233945f5-5e47-4f4a-a963-2c6eef2347a3","name":"Delete table or rows1","credentials":{"postgres":{"id":"QZR6jt2yEz1JBvqt","name":"Postgres account"}}},{"parameters":{"model":{"__rl":true,"value":"gpt-4o","mode":"list","cachedResultName":"gpt-4o"},"options":{"maxTokens":500,"temperature":0.7,"timeout":40000,"maxRetries":2}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[2680,1280],"id":"4d2270bb-29fd-4998-b3fe-4432201e13b5","name":"OpenAI Chat Model","credentials":{"openAiApi":{"id":"uu3Gb39bRtnzP2bu","name":"OpenAI Andre"}}},{"parameters":{"method":"POST","url":"=https://api.z-api.io/instances/3E34B1796728001766CE728A74374CC1/token/739DBE0A3929A921D34BED2D/send-text","authentication":"predefinedCredentialType","nodeCredentialType":"zapiApi","sendBody":true,"bodyParameters":{"parameters":[{"name":"phone","value":"={{ $('Dados').item.json.remoteJid }}"},{"name":"message","value":"=Desculpe, houve erro de processamento, poderia repetir sua resposta?"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[4060,580],"id":"ca432da8-d98c-413f-b139-86ca0f0a57af","name":"Z-API - Dados3","credentials":{"zapiApi":{"id":"Mvy87oy1GvsL7pPH","name":"Z-API account"}}},{"parameters":{"method":"POST","url":"=https://api.z-api.io/instances/3E34B1796728001766CE728A74374CC1/token/739DBE0A3929A921D34BED2D/send-text","authentication":"predefinedCredentialType","nodeCredentialType":"zapiApi","sendBody":true,"bodyParameters":{"parameters":[{"name":"phone","value":"={{ $('Dados').item.json.remoteJid }}"},{"name":"message","value":"=Desculpe, houve erro de processamento, poderia repetir sua resposta?"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[5260,1800],"id":"4f87bb67-df08-4e70-bb70-2c230d6c1ec7","name":"Z-API - Dados4","credentials":{"zapiApi":{"id":"Mvy87oy1GvsL7pPH","name":"Z-API account"}}},{"parameters":{"queue":"ia-tecvitoria","options":{}},"type":"n8n-nodes-base.rabbitmq","typeVersion":1.1,"position":[-100,1000],"id":"c9f8a1eb-2470-4e35-9846-4ff836d6ec83","name":"RabbitMQ","credentials":{"rabbitmq":{"id":"zsHCfy8AaJSgjGNk","name":"RabbitMQ account"}}},{"parameters":{"queue":"ia-tecvitoria","options":{"acknowledge":"executionFinishesSuccessfully","jsonParseBody":true}},"type":"n8n-nodes-base.rabbitmqTrigger","typeVersion":1,"position":[240,1000],"id":"46018822-368a-49a2-9d60-02b00943ebe6","name":"RabbitMQ Trigger","credentials":{"rabbitmq":{"id":"zsHCfy8AaJSgjGNk","name":"RabbitMQ account"}}},{"parameters":{"assignments":{"assignments":[{"id":"2911e082-e712-4b85-bcf7-611f60d1559f","name":"remoteJid","value":"={{ $json.body.phone }}","type":"string"},{"id":"f2af5f89-8957-4811-9839-8ef571b38e5c","name":"fromMe","value":"={{ $json.body.fromMe }}","type":"boolean"},{"id":"16a9c5c0-5a35-4db2-ab94-ef251115696f","name":"conversation","value":"={{ $json.body.text?.message || $json.body.buttonsResponseMessage?.message || $json.body.listResponseMessage?.title || 'Mensagem não encontrada' }}","type":"string"},{"id":"20937be5-8999-4d95-91cb-5aa9490f166c","name":"date_time","value":"={{ $json.body.date_time }}","type":"string"},{"id":"fa5a0f16-b265-40ab-9299-135659bbf90e","name":"messageType","value":"={{ $json.body.type }}","type":"string"},{"id":"95ca6185-7794-4411-82c5-d30676a6ca52","name":"evo.instance","value":"={{ $json.body.instanceId }}","type":"string"},{"id":"66fcd40d-88da-4117-958d-7b4a29454136","name":"evo.server_url","value":"={{ $json.body.server_url }}","type":"string"},{"id":"477ee9d8-59d3-4dd4-9eab-038367517cb1","name":"evo.apikey","value":"={{ $json.body.apikey }}","type":"string"},{"id":"89c694a3-3a94-4bf2-8d8d-016bafa3040e","name":"time_out","value":60,"type":"number"},{"id":"95eb2166-9205-4b79-ab5d-0c98fc3969ee","name":"client","value":"","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-320,1000],"id":"0293e845-3cc9-48cb-8dcd-c37232e37efb","name":"Dados2"},{"parameters":{"method":"POST","url":"=https://api.z-api.io/instances/3E34B1796728001766CE728A74374CC1/token/739DBE0A3929A921D34BED2D/send-text","authentication":"predefinedCredentialType","nodeCredentialType":"zapiApi","sendBody":true,"bodyParameters":{"parameters":[{"name":"phone","value":"={{ $('Dados').item.json.remoteJid }}"},{"name":"message","value":"=Memória apagada"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1680,680],"id":"ec4394ea-6bfb-4f4f-ae83-38336ce9e75d","name":"Z-API - Dados5","retryOnFail":true,"credentials":{"zapiApi":{"id":"Mvy87oy1GvsL7pPH","name":"Z-API account"}},"onError":"continueErrorOutput"},{"parameters":{"jsCode":"// Garante que só o primeiro item seja retornado como array com 1 item\nreturn [ { json: items[0].json } ];"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[3680,660],"id":"4cc20fde-d541-4da9-9062-bc4022571d5c","name":"Code10","disabled":true},{"parameters":{"operation":"update","tableId":"qualification_results","filters":{"conditions":[{"keyName":"Phone","condition":"eq","keyValue":"={{ $('Process Qualification Data').item.json.whatsapp }}"}]},"fieldsUi":{"fieldValues":[{"fieldId":"Plano de negócios","fieldValue":"={{ $('Process Qualification Data').item.json.dadosOriginais.respostas.modeloNegocio ? 'Sim' : 'Não' }}"},{"fieldId":"TamSamSom","fieldValue":"={{ $('Process Qualification Data').item.json.respostas.tamSamSom ? 'Sim' : 'Não' }}"},{"fieldId":"Pesquisa qualitativa:","fieldValue":"={{ \n  $('Process Qualification Data').item.json.respostas.pesquisaQualitativa === 'informal' \n    ? 'Informalmente sem dados registrados' \n    : (\n        $('Process Qualification Data').item.json.respostas.pesquisaQualitativa === 'nao_realizei' \n          ? 'Ainda não realizei' \n          : (\n              $('Process Qualification Data').item.json.respostas.pesquisaQualitativa === 'dados_organizados' \n                ? 'Sim, com dados organizados' \n                : $('Process Qualification Data').item.json.respostas.pesquisaQualitativa\n            )\n      )\n}}"},{"fieldId":"Mapeamento concorrentes","fieldValue":"={{ \n  $('Process Qualification Data').item.json.respostas.concorrentes === 'informal' \n    ? 'Fiz informalmente, mas sem dados registrados' \n    : (\n        $('Process Qualification Data').item.json.respostas.concorrentes === 'nao_realizei' \n          ? 'Ainda não realizei' \n          : (\n              $('Process Qualification Data').item.json.respostas.concorrentes === 'dados_organizados' \n                ? 'Sim, com dados organizados' \n                : $('Process Qualification Data').item.json.respostas.concorrentes\n            )\n      )\n}}"},{"fieldId":"Persona","fieldValue":"={{ $('Process Qualification Data').item.json.respostas.persona ? 'Sim' : 'Não' }}"},{"fieldId":"Pitch","fieldValue":"={{ $('Process Qualification Data').item.json.respostas.pitch ? 'Sim' : 'Não' }}"},{"fieldId":"Programas","fieldValue":"={{ $('Process Qualification Data').item.json.respostas.programasAnteriores ? 'Sim' : 'Não' }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[5500,1060],"id":"8b93021f-bf3d-420c-9c24-e076a8111cbc","name":"Update a row","credentials":{"supabaseApi":{"id":"OaqABPiG2T08H6kW","name":"Supabase account"}}}],"connections":{"Process Qualification Data":{"main":[[{"node":"If","type":"main","index":0}]]},"Check Completion Status":{"main":[[{"node":"Switch","type":"main","index":0}],[{"node":"Code3","type":"main","index":0}]]},"Supabase":{"main":[[{"node":"Check Completion Status","type":"main","index":0}]]},"AI Agent - TecVitória Qualification1":{"main":[[{"node":"Process Qualification Data","type":"main","index":0}]]},"If":{"main":[[{"node":"If3","type":"main","index":0}],[{"node":"If1","type":"main","index":0}]]},"Supabase1":{"main":[[{"node":"Check Completion Status","type":"main","index":0}]]},"If1":{"main":[[{"node":"Supabase","type":"main","index":0}],[{"node":"Supabase1","type":"main","index":0}]]},"Auto-fixing Output Parser":{"ai_outputParser":[[{"node":"AI Agent - TecVitória Qualification1","type":"ai_outputParser","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"Auto-fixing Output Parser","type":"ai_outputParser","index":0}]]},"Code":{"main":[[{"node":"Aprovado para Incubação","type":"main","index":0}]]},"Code1":{"main":[[{"node":"Aprovado para Startec","type":"main","index":0}]]},"Code2":{"main":[[{"node":"Inscrição Trilha da Inovação","type":"main","index":0}]]},"Code3":{"main":[[{"node":"Pergunta 3?","type":"main","index":0}]]},"Switch":{"main":[[{"node":"Code","type":"main","index":0}],[{"node":"Code1","type":"main","index":0}],[{"node":"Code2","type":"main","index":0}]]},"Webhook":{"main":[[{"node":"Dados2","type":"main","index":0}]]},"Dados":{"main":[[{"node":"Get many rows","type":"main","index":0}]]},"If3":{"main":[[{"node":"Z-API - Dados","type":"main","index":0}],[{"node":"Code10","type":"main","index":0}]]},"When chat message received":{"main":[[{"node":"If6","type":"main","index":0}]]},"Dados1":{"main":[[{"node":"AI Agent - TecVitória Qualification1","type":"main","index":0}]]},"If6":{"main":[[],[{"node":"Dados1","type":"main","index":0}]]},"Aprovado para Incubação":{"main":[[{"node":"Wait","type":"main","index":0}]]},"Aprovado para Startec":{"main":[[{"node":"Wait1","type":"main","index":0}]]},"Inscrição Trilha da Inovação":{"main":[[{"node":"Wait2","type":"main","index":0}]]},"Pergunta 3?":{"main":[[{"node":"Z-API - Lista - Pergunta 3","type":"main","index":0}],[{"node":"Pergunta 4?","type":"main","index":0}]]},"Pergunta 4?":{"main":[[{"node":"Z-API Lista Pergunta 4","type":"main","index":0}],[{"node":"Z-API - Botões Perguntas 2, 5, 6, 7","type":"main","index":0}]]},"Supabase6":{"main":[[{"node":"If2","type":"main","index":0}]]},"If2":{"main":[[],[{"node":"AI Agent - TecVitória Qualification1","type":"main","index":0}]]},"Get many rows":{"main":[[{"node":"Switch2","type":"main","index":0}]]},"If5":{"main":[[{"node":"Recomeçar","type":"main","index":0}],[{"node":"Supabase6","type":"main","index":0}]]},"Switch2":{"main":[[{"node":"Z-API - Dados1","type":"main","index":0}],[{"node":"If7","type":"main","index":0}],[{"node":"Aprovado para Incubação1","type":"main","index":0}],[{"node":"AI Agent","type":"main","index":0}]]},"Z-API - Dados1":{"main":[[{"node":"Delete table or rows","type":"main","index":0}]]},"Supabase4":{"main":[[{"node":"AI Agent - TecVitória Qualification1","type":"main","index":0}]]},"If7":{"main":[[{"node":"Delete table or rows1","type":"main","index":0}],[{"node":"If5","type":"main","index":0}]]},"Wait":{"main":[[{"node":"Feedback","type":"main","index":0}]]},"Wait1":{"main":[[{"node":"Feedback","type":"main","index":0}]]},"Wait2":{"main":[[{"node":"Feedback","type":"main","index":0}]]},"AI Agent":{"main":[[{"node":"Z-API - Dados2","type":"main","index":0}]]},"OpenAI Chat Model1":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Feedback":{"main":[[{"node":"Update a row","type":"main","index":0}]]},"Postgres Chat Memory":{"ai_memory":[[{"node":"AI Agent - TecVitória Qualification1","type":"ai_memory","index":0}]]},"Delete table or rows":{"main":[[{"node":"Supabase4","type":"main","index":0}]]},"Delete table or rows1":{"main":[[{"node":"Supabase5","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"AI Agent - TecVitória Qualification1","type":"ai_languageModel","index":0},{"node":"Auto-fixing Output Parser","type":"ai_languageModel","index":0}]]},"Z-API - Botões Pergunta 1":{"main":[[],[{"node":"Z-API - Dados3","type":"main","index":0}]]},"Z-API - Dados":{"main":[[],[{"node":"Z-API - Dados3","type":"main","index":0}]]},"Z-API - Lista - Pergunta 3":{"main":[[],[{"node":"Z-API - Dados4","type":"main","index":0}]]},"Z-API Lista Pergunta 4":{"main":[[],[{"node":"Z-API - Dados4","type":"main","index":0}]]},"Z-API - Botões Perguntas 2, 5, 6, 7":{"main":[[],[{"node":"Z-API - Dados4","type":"main","index":0}]]},"RabbitMQ Trigger":{"main":[[{"node":"Dados","type":"main","index":0}]]},"Dados2":{"main":[[{"node":"RabbitMQ","type":"main","index":0}]]},"Recomeçar":{"main":[[{"node":"AI Agent - TecVitória Qualification1","type":"main","index":0}]]},"Supabase5":{"main":[[{"node":"Z-API - Dados5","type":"main","index":0}]]},"Code10":{"main":[[{"node":"Z-API - Botões Pergunta 1","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"Webhook":[{"json":{"headers":{"host":"webhook.tecvitoria.com.br","user-agent":"Mozilla/5.0 (X11; Linux x86_64; rv:111.0) Gecko/20100101 Firefox/111.0","content-length":"755","content-type":"application/json","origin":"https://api.z-api.io","server":"Z-API","x-forwarded-for":"146.235.42.234","x-forwarded-host":"webhook.tecvitoria.com.br","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"0caea1c95d30","x-real-ip":"146.235.42.234","z-api-token":"739DBE0A3929A921D34BED2D","accept-encoding":"gzip"},"params":{},"query":{},"body":{"isStatusReply":false,"chatLid":"196722538094652@lid","connectedPhone":"5527992549780","waitingMessage":false,"isEdit":false,"isGroup":false,"isNewsletter":false,"instanceId":"3E34B1796728001766CE728A74374CC1","messageId":"F643E5F34E660FE3FF66C64BB51C420A","phone":"5511994774816","fromMe":false,"momment":1751557999000,"status":"RECEIVED","chatName":"André Luiz","senderPhoto":null,"senderName":"André Luiz","photo":"https://pps.whatsapp.net/v/t61.24694-24/475200150_1730935324152518_2884271197856761311_n.jpg?ccb=11-4&oh=01_Q5Aa1wHSlfxX3T83AqEZcdieQ5f-yr-LtldwvFjG9QUa9Jyc9g&oe=68739AD9&_nc_sid=5e03e0&_nc_cat=105","broadcast":false,"participantLid":null,"forwarded":false,"type":"ReceivedCallback","fromApi":false,"text":{"message":"5511994774861"}},"webhookUrl":"https://webhook.tecvitoria.com.br/webhook/incubadora","executionMode":"production"}}],"RabbitMQ Trigger":[{"json":{"fields":{"consumerTag":"amq.ctag-uO42qMVwVi9ISn6WBoclwQ","deliveryTag":2,"redelivered":false,"exchange":"","routingKey":"ia-tecvitoria"},"properties":{"headers":{}},"content":{"remoteJid":"5511973273648","fromMe":false,"conversation":"Sim","date_time":null,"messageType":"ReceivedCallback","evo":{"instance":"3E34B1796728001766CE728A74374CC1","server_url":null,"apikey":null},"time_out":60,"client":""}}}]},"versionId":"22d11dd0-3b0d-4b51-9ea0-571a664c43c7","triggerCount":3,"shared":[{"createdAt":"2025-07-09T20:43:13.635Z","updatedAt":"2025-07-09T20:43:13.635Z","role":"workflow:owner","workflowId":"FdXQjvvC6zJPNOIw","projectId":"bmuGqAprRmP37IQy"}],"tags":[]}